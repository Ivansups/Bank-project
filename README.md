# Анализ предметной области: «Информационная система банковского сервиса»

## Содержание

1. [Анализ предметной области](#1-анализ-предметной-области)
2. [Акторы](#2-акторы)
3. [Сущности](#3-сущности)
4. [Описание свойств (атрибутов) концептуальных классов](#4-описание-свойств-атрибутов-концептуальных-классов)
5. [Построение модели предметной области в виде диаграммы концептуальных классов](#5-построение-модели-предметной-области-в-виде-диаграммы-концептуальных-классов)
6. [Проблемы акторов](#6-проблемы-акторов-которые-могут-быть-решены-с-помощью-планируемого-к-разработке-программного-средства)
7. [Варианты использования (прецеденты)](#7-варианты-использования-прецеденты-для-планируемого-к-разработке-программного-средства)
8. [Планируемые средства разработки](#8-планируемые-средства-разработки)
9. [Перечень требований](#9-перечень-требований)

---

## 1. Анализ предметной области

Предметной областью, с которой связан данный проект, является сфера банковских услуг и финансовых операций. Банковская система представляет собой комплексную инфраструктуру, включающую в себя финансовые учреждения, клиентов, различные виды банковских продуктов и услуг.

Современные банковские системы обеспечивают:
- Управление клиентскими счетами и картами
- Обработку финансовых транзакций
- Системы аутентификации и авторизации
- Административное управление пользователями
- Кредитные операции

Основными участниками банковской экосистемы являются:
- **Клиенты банка** - физические лица, пользующиеся банковскими услугами
- **Администраторы** - сотрудники банка, управляющие системой
- **Банковские карты** - инструменты для проведения финансовых операций
- **Транзакции** - операции по движению денежных средств
- **Кредиты** - заемные средства, предоставляемые клиентам

---

## 2. Акторы

Активные участники деятельности в данной предметной области:

### 2.1. Клиент банка
- Основной пользователь системы
- Управляет своими банковскими картами
- Проводит финансовые транзакции
- Просматривает историю операций
- Управляет профилем

### 2.2. Администратор системы
- Управляет пользователями системы
- Контролирует все транзакции
- Имеет доступ к административным функциям
- Может просматривать статистику по всем операциям

---

## 3. Сущности

Концептуальные классы, выделенные из описания предметной области:

### 3.1. Пользователь (User)
- Основная сущность системы
- Содержит персональную информацию
- Связан с банковскими картами и транзакциями

### 3.2. Банковская карта (Card)
- Инструмент для проведения операций
- Содержит информацию о балансе
- Принадлежит конкретному пользователю

### 3.3. Транзакция (Transaction)
- Операция по движению денежных средств
- Может быть пополнением или списанием
- Связана с пользователем и картой

### 3.4. Кредит (Credit)
- Заемные средства
- Может быть кредитом или долгом
- Связан с пользователем

### 3.5. Заявка на кредит (CreditRequest)
- Запрос на получение кредита от пользователя
- Требует одобрения администратора
- Содержит статус обработки

### 3.6. Заявка на перевод (TransactionRequest)
- Запрос на проведение транзакции
- Требует одобрения администратора для крупных сумм
- Содержит статус обработки

### 3.7. Действие администратора (AdminAction)
- Логирование действий администратора
- Содержит информацию о типе действия и результате
- Связано с администратором и соответствующими сущностями

### 3.8. Администратор (Admin)
- Специальная роль пользователя
- Имеет расширенные права доступа
- Может одобрять/отклонять заявки

---

## 4. Описание свойств (атрибутов) концептуальных классов

### 4.1. Пользователь (User)
- `id` - уникальный идентификатор (UUID)
- `yandex_id` - идентификатор в системе Яндекс OAuth (String, уникальный)
- `name` - имя пользователя (String, обязательное)
- `email` - электронная почта (String, обязательное, уникальный)
- `avatar` - аватар пользователя (String, опциональный)
- `last_login` - время последнего входа (DateTime, опциональный)
- `createdAt` - дата создания (DateTime, автоматическая)
- `updatedAt` - дата обновления (DateTime, автоматическая)

### 4.2. Банковская карта (Card)
- `id` - уникальный идентификатор (UUID)
- `amount` - баланс карты (Integer, обязательное)
- `user_id` - идентификатор владельца (UUID, внешний ключ)
- `createdAt` - дата создания (DateTime, автоматическая)
- `updatedAt` - дата обновления (DateTime, автоматическая)

### 4.3. Транзакция (Transaction)
- `id` - уникальный идентификатор (UUID)
- `amount` - сумма транзакции (Float, обязательное)
- `user_id` - идентификатор пользователя (UUID, внешний ключ)
- `transaction_type` - тип транзакции (Enum: ADD/SUB, обязательное)
- `createdAt` - дата создания (DateTime, автоматическая)
- `updatedAt` - дата обновления (DateTime, автоматическая)

### 4.4. Кредит (Credit)
- `id` - уникальный идентификатор (UUID)
- `amount` - сумма кредита (Integer, обязательное)
- `user_id` - идентификатор пользователя (UUID, внешний ключ)
- `credit_type` - тип кредита (Enum: CREDIT/DEBT, обязательное)
- `status` - статус кредита (Enum: ACTIVE/PAID/OVERDUE, обязательное)
- `createdAt` - дата создания (DateTime, автоматическая)
- `updatedAt` - дата обновления (DateTime, автоматическая)

### 4.5. Заявка на кредит (CreditRequest)
- `id` - уникальный идентификатор (UUID)
- `amount` - запрашиваемая сумма (Integer, обязательное)
- `user_id` - идентификатор пользователя (UUID, внешний ключ)
- `status` - статус заявки (Enum: PENDING/APPROVED/REJECTED, обязательное)
- `admin_id` - идентификатор администратора (UUID, внешний ключ, опциональный)
- `reason` - причина отклонения (String, опциональный)
- `createdAt` - дата создания (DateTime, автоматическая)
- `updatedAt` - дата обновления (DateTime, автоматическая)

### 4.6. Заявка на перевод (TransactionRequest)
- `id` - уникальный идентификатор (UUID)
- `amount` - сумма перевода (Float, обязательное)
- `user_id` - идентификатор пользователя (UUID, внешний ключ)
- `transaction_type` - тип транзакции (Enum: ADD/SUB, обязательное)
- `status` - статус заявки (Enum: PENDING/APPROVED/REJECTED, обязательное)
- `admin_id` - идентификатор администратора (UUID, внешний ключ, опциональный)
- `reason` - причина отклонения (String, опциональный)
- `createdAt` - дата создания (DateTime, автоматическая)
- `updatedAt` - дата обновления (DateTime, автоматическая)

### 4.7. Действие администратора (AdminAction)
- `id` - уникальный идентификатор (UUID)
- `admin_id` - идентификатор администратора (UUID, внешний ключ)
- `action_type` - тип действия (Enum: APPROVE_CREDIT/REJECT_CREDIT/APPROVE_TRANSACTION/REJECT_TRANSACTION, обязательное)
- `target_id` - идентификатор целевой сущности (UUID, обязательное)
- `target_type` - тип целевой сущности (Enum: CREDIT_REQUEST/TRANSACTION_REQUEST, обязательное)
- `description` - описание действия (String, опциональный)
- `createdAt` - дата создания (DateTime, автоматическая)

### 4.8. Администратор (Admin)
- `id` - уникальный идентификатор (UUID)
- `user_id` - идентификатор пользователя (UUID, внешний ключ)
- `permissions` - права доступа (Array[String], обязательное)
- `createdAt` - дата создания (DateTime, автоматическая)
- `updatedAt` - дата обновления (DateTime, автоматическая)

---

## 5. Построение модели предметной области в виде диаграммы концептуальных классов

```
┌─────────────────┐    1     ┌─────────────────┐
│     User        │◄─────────┤      Admin      │
│                 │          │                 │
│ - id: UUID      │          │ - id: UUID      │
│ - yandex_id     │          │ - user_id: UUID │
│ - name: String  │          │ - permissions   │
│ - email: String │          │ - createdAt     │
│ - avatar: String│          │ - updatedAt     │
│ - last_login    │          └─────────────────┘
│ - createdAt     │                   │
│ - updatedAt     │                   │ 1
└─────────────────┘                   │
         │                            │
         │ 1                          ▼
         │                   ┌─────────────────┐
         ▼                   │  AdminAction    │
┌─────────────────┐          │                 │
│      Card       │          │ - id: UUID      │
│                 │          │ - admin_id: UUID│
│ - id: UUID      │          │ - action_type   │
│ - amount: Int   │          │ - target_id: UUID│
│ - user_id: UUID │          │ - target_type   │
│ - createdAt     │          │ - description   │
│ - updatedAt     │          │ - createdAt     │
└─────────────────┘          └─────────────────┘

┌─────────────────┐    1     ┌─────────────────┐
│     User        │◄─────────┤  Transaction    │
│                 │          │                 │
│ - id: UUID      │          │ - id: UUID      │
│ - yandex_id     │          │ - amount: Float │
│ - name: String  │          │ - user_id: UUID │
│ - email: String │          │ - type: Enum    │
│ - avatar: String│          │ - createdAt     │
│ - last_login    │          │ - updatedAt     │
│ - createdAt     │          └─────────────────┘
│ - updatedAt     │
└─────────────────┘
         │
         │ 1
         │
         ▼
┌─────────────────┐
│     Credit      │
│                 │
│ - id: UUID      │
│ - amount: Int   │
│ - user_id: UUID │
│ - type: Enum    │
│ - status: Enum  │
│ - createdAt     │
│ - updatedAt     │
└─────────────────┘

┌─────────────────┐    1     ┌─────────────────┐
│     User        │◄─────────┤ CreditRequest   │
│                 │          │                 │
│ - id: UUID      │          │ - id: UUID      │
│ - yandex_id     │          │ - amount: Int   │
│ - name: String  │          │ - user_id: UUID │
│ - email: String │          │ - status: Enum  │
│ - avatar: String│          │ - admin_id: UUID│
│ - last_login    │          │ - reason: String│
│ - createdAt     │          │ - createdAt     │
│ - updatedAt     │          │ - updatedAt     │
└─────────────────┘          └─────────────────┘

┌─────────────────┐    1     ┌─────────────────┐
│     User        │◄─────────┤TransactionRequest│
│                 │          │                 │
│ - id: UUID      │          │ - id: UUID      │
│ - yandex_id     │          │ - amount: Float │
│ - name: String  │          │ - user_id: UUID │
│ - email: String │          │ - type: Enum    │
│ - avatar: String│          │ - status: Enum  │
│ - last_login    │          │ - admin_id: UUID│
│ - createdAt     │          │ - reason: String│
│ - updatedAt     │          │ - createdAt     │
└─────────────────┘          │ - updatedAt     │
                              └─────────────────┘
```

### Связи между сущностями:
- **User ↔ Admin**: Один к одному (1:1) - пользователь может быть администратором
- **User ↔ Card**: Один ко многим (1:N) - у пользователя может быть несколько карт
- **User ↔ Transaction**: Один ко многим (1:N) - у пользователя может быть много транзакций
- **User ↔ Credit**: Один ко многим (1:N) - у пользователя может быть несколько кредитов
- **User ↔ CreditRequest**: Один ко многим (1:N) - у пользователя может быть много заявок на кредит
- **User ↔ TransactionRequest**: Один ко многим (1:N) - у пользователя может быть много заявок на перевод
- **Admin ↔ AdminAction**: Один ко многим (1:N) - администратор может выполнять много действий
- **Admin ↔ CreditRequest**: Один ко многим (1:N) - администратор может обрабатывать много заявок на кредит
- **Admin ↔ TransactionRequest**: Один ко многим (1:N) - администратор может обрабатывать много заявок на перевод

---

## 6. Проблемы акторов, которые могут быть решены с помощью планируемого к разработке программного средства

### 6.1. Проблемы клиента банка:
- **Необходимость в удобном доступе к банковским услугам через веб-интерфейс**
  - Решение: Современный веб-интерфейс на Next.js с адаптивным дизайном
- **Потребность в быстрой аутентификации через популярные OAuth-провайдеры**
  - Решение: Интеграция с Яндекс OAuth для быстрого входа
- **Необходимость в управлении банковскими картами и просмотре баланса**
  - Решение: CRUD операции для карт с отображением баланса
- **Потребность в отслеживании истории транзакций**
  - Решение: Система транзакций с историей операций
- **Необходимость в проведении финансовых операций (пополнение/списание)**
  - Решение: Создание транзакций с типами ADD/SUB

### 6.2. Проблемы администратора:
- **Необходимость в централизованном управлении пользователями**
  - Решение: Административная панель с управлением пользователями
- **Потребность в мониторинге всех транзакций в системе**
  - Решение: Просмотр всех транзакций с фильтрацией
- **Необходимость в контроле административных функций**
  - Решение: Система ролей с административными правами
- **Потребность в получении статистики по операциям**
  - Решение: Дашборд с аналитикой и статистикой
- **Необходимость в мануальном одобрении кредитных заявок**
  - Решение: Система заявок на кредит с возможностью одобрения/отклонения
- **Потребность в контроле крупных финансовых операций**
  - Решение: Система заявок на перевод с административным одобрением
- **Необходимость в аудите действий администраторов**
  - Решение: Логирование всех административных действий

---

## 7. Варианты использования (прецеденты) для планируемого к разработке программного средства

### 7.1. Аутентификация пользователя
- **UC-001: Вход через Яндекс OAuth**
  - Актор: Клиент банка
  - Описание: Пользователь входит в систему через Яндекс OAuth
- **UC-002: Синхронизация данных пользователя**
  - Актор: Система
  - Описание: Автоматическая синхронизация данных из Яндекс OAuth
- **UC-003: Выход из системы**
  - Актор: Клиент банка
  - Описание: Пользователь выходит из системы

### 7.2. Управление профилем
- **UC-004: Просмотр личной информации**
  - Актор: Клиент банка
  - Описание: Просмотр данных профиля
- **UC-005: Обновление данных профиля**
  - Актор: Клиент банка
  - Описание: Изменение личной информации

### 7.3. Управление банковскими картами
- **UC-006: Создание новой карты**
  - Актор: Клиент банка
  - Описание: Создание новой банковской карты
- **UC-007: Просмотр баланса карты**
  - Актор: Клиент банка
  - Описание: Просмотр текущего баланса карты
- **UC-008: Обновление информации о карте**
  - Актор: Клиент банка
  - Описание: Изменение данных карты
- **UC-009: Удаление карты**
  - Актор: Клиент банка
  - Описание: Удаление банковской карты

### 7.4. Управление транзакциями
- **UC-010: Создание транзакции (пополнение/списание)**
  - Актор: Клиент банка
  - Описание: Проведение финансовой операции
- **UC-011: Просмотр истории транзакций**
  - Актор: Клиент банка
  - Описание: Просмотр всех транзакций пользователя
- **UC-012: Фильтрация транзакций по типу**
  - Актор: Клиент банка
  - Описание: Фильтрация транзакций по типу операции

### 7.5. Управление кредитными заявками
- **UC-013: Подача заявки на кредит**
  - Актор: Клиент банка
  - Описание: Создание заявки на получение кредита
- **UC-014: Просмотр заявок на кредит**
  - Актор: Администратор
  - Описание: Просмотр всех заявок на кредит в системе
- **UC-015: Одобрение заявки на кредит**
  - Актор: Администратор
  - Описание: Одобрение заявки на кредит с созданием кредита
- **UC-016: Отклонение заявки на кредит**
  - Актор: Администратор
  - Описание: Отклонение заявки на кредит с указанием причины

### 7.6. Управление заявками на перевод
- **UC-017: Подача заявки на крупный перевод**
  - Актор: Клиент банка
  - Описание: Создание заявки на крупную финансовую операцию
- **UC-018: Просмотр заявок на перевод**
  - Актор: Администратор
  - Описание: Просмотр всех заявок на перевод в системе
- **UC-019: Одобрение заявки на перевод**
  - Актор: Администратор
  - Описание: Одобрение заявки на перевод с созданием транзакции
- **UC-020: Отклонение заявки на перевод**
  - Актор: Администратор
  - Описание: Отклонение заявки на перевод с указанием причины

### 7.7. Административные функции
- **UC-021: Просмотр всех пользователей**
  - Актор: Администратор
  - Описание: Просмотр списка всех пользователей системы
- **UC-022: Управление правами доступа**
  - Актор: Администратор
  - Описание: Назначение/отзыв административных прав
- **UC-023: Мониторинг системы**
  - Актор: Администратор
  - Описание: Просмотр статистики и мониторинг системы
- **UC-024: Просмотр логов административных действий**
  - Актор: Администратор
  - Описание: Просмотр истории всех административных действий

---

## 8. Планируемые средства разработки

### 8.1. Frontend:
- **Next.js 15** - React фреймворк с App Router
- **TypeScript** - типизированный JavaScript
- **TailwindCSS** - utility-first CSS фреймворк
- **NextAuth.js v5** - аутентификация
- **Yandex OAuth** - авторизация

### 8.2. Backend:
- **FastAPI** - современный Python веб-фреймворк
- **SQLAlchemy** - ORM для работы с БД
- **PostgreSQL** - реляционная база данных
- **Pydantic** - валидация данных
- **Alembic** - миграции БД

### 8.3. DevOps:
- **Docker** - контейнеризация
- **Docker Compose** - оркестрация контейнеров

### 8.4. Необходимое оборудование:
- Сервер с поддержкой Docker
- База данных PostgreSQL
- Веб-сервер для развертывания

---

## 9. Перечень требований

### 9.1. Функциональные требования:

#### 9.1.1. Аутентификация и авторизация:
- **FR-001**: Система должна поддерживать вход через Яндекс OAuth
- **FR-002**: Система должна автоматически синхронизировать данные пользователя
- **FR-003**: Система должна обеспечивать защищенные маршруты
- **FR-004**: Система должна поддерживать роли пользователей (клиент/администратор)

#### 9.1.2. Управление пользователями:
- **FR-005**: Система должна позволять создание новых пользователей
- **FR-006**: Система должна позволять просмотр информации о пользователях
- **FR-007**: Система должна позволять обновление данных пользователей
- **FR-008**: Система должна позволять удаление пользователей
- **FR-009**: Система должна позволять просмотр профиля пользователя
- **FR-010**: Система должна позволять управление административными правами

#### 9.1.3. Управление банковскими картами:
- **FR-011**: Система должна позволять создание новых карт
- **FR-012**: Система должна отображать баланс карт
- **FR-013**: Система должна позволять обновление информации о картах
- **FR-014**: Система должна позволять удаление карт

#### 9.1.4. Управление транзакциями:
- **FR-015**: Система должна позволять создание транзакций (пополнение/списание)
- **FR-016**: Система должна отображать историю транзакций
- **FR-017**: Система должна позволять фильтрацию по типу операций

#### 9.1.5. Управление кредитными заявками:
- **FR-018**: Система должна позволять создание заявок на кредит
- **FR-019**: Система должна позволять просмотр всех заявок на кредит
- **FR-020**: Система должна позволять одобрение заявок на кредит
- **FR-021**: Система должна позволять отклонение заявок на кредит с указанием причины
- **FR-022**: Система должна автоматически создавать кредит при одобрении заявки

#### 9.1.6. Управление заявками на перевод:
- **FR-023**: Система должна позволять создание заявок на крупные переводы
- **FR-024**: Система должна позволять просмотр всех заявок на перевод
- **FR-025**: Система должна позволять одобрение заявок на перевод
- **FR-026**: Система должна позволять отклонение заявок на перевод с указанием причины
- **FR-027**: Система должна автоматически создавать транзакцию при одобрении заявки

#### 9.1.7. Административные функции:
- **FR-028**: Система должна позволять просмотр всех пользователей
- **FR-029**: Система должна позволять мониторинг транзакций
- **FR-030**: Система должна предоставлять административные функции
- **FR-031**: Система должна логировать все административные действия
- **FR-032**: Система должна позволять просмотр логов административных действий

### 9.2. Нефункциональные требования:

#### 9.2.1. Производительность:
- **NFR-001**: Время отклика API не должно превышать 500мс
- **NFR-002**: Система должна поддерживать до 1000 одновременных пользователей
- **NFR-003**: Система должна использовать асинхронную обработку запросов

#### 9.2.2. Безопасность:
- **NFR-004**: Система должна использовать JWT токены для аутентификации
- **NFR-005**: Система должна валидировать все входящие данные
- **NFR-006**: Система должна быть защищена от SQL инъекций
- **NFR-007**: Система должна иметь настроенные CORS политики
- **NFR-008**: Система должна хешировать пароли

#### 9.2.3. Надежность:
- **NFR-009**: Система должна автоматически восстанавливать контейнеры
- **NFR-010**: Система должна логировать все операции
- **NFR-011**: Система должна иметь health check для базы данных
- **NFR-012**: Система должна обрабатывать ошибки

#### 9.2.4. Масштабируемость:
- **NFR-013**: Система должна быть контейнеризована с Docker
- **NFR-014**: Система должна поддерживать горизонтальное масштабирование
- **NFR-015**: Система должна использовать микросервисную архитектуру

#### 9.2.5. Удобство использования:
- **NFR-016**: Система должна иметь современный и интуитивный интерфейс
- **NFR-017**: Система должна иметь адаптивный дизайн
- **NFR-018**: Система должна обеспечивать быструю навигацию
- **NFR-019**: Система должна предоставлять информативные сообщения об ошибках

#### 9.2.6. Совместимость:
- **NFR-020**: Система должна поддерживать современные браузеры
- **NFR-021**: Система должна предоставлять RESTful API
- **NFR-022**: Система должна использовать JSON формат данных
- **NFR-023**: Система должна быть кроссплатформенной

---

## Заключение

Данный анализ предметной области обеспечивает полное понимание банковской системы и служит основой для дальнейшего проектирования и разработки приложения. Система предназначена для обеспечения удобного и безопасного управления банковскими операциями через современный веб-интерфейс с интеграцией популярных OAuth-провайдеров.

Ключевые особенности системы:
- Современная архитектура с использованием Next.js и FastAPI
- Безопасная аутентификация через Яндекс OAuth
- Полнофункциональное управление банковскими картами и транзакциями
- Система мануального одобрения кредитных заявок администраторами
- Контроль крупных финансовых операций через заявки на перевод
- Административные функции для управления системой
- Полное логирование административных действий для аудита
- Контейнеризация для простого развертывания и масштабирования
